<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quebra-Cabe√ßa de N√∫meros ‚Äî SCALFORCE</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#140a1a;
      --primary:#5E2497;
      --accent:#ff8a00;
      --text:#ffffff;
      --muted:#cfc6d9;
      --card:#1e1130;
      --success:#36c38d;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Poppins,sans-serif;color:var(--text);background:linear-gradient(180deg,#1a0f26 100%,#140a1a 100%)}
    .container{width:min(1200px,92%);margin-inline:auto}
    header{position:sticky;top:0;z-index:10;background:#140a1a}
    .nav{display:flex;align-items:center;justify-content:space-between;gap:1rem;padding:1rem 0}
    .brand{display:flex;align-items:center;gap:.8rem;font-weight:800;text-decoration:none;color:var(--text);}
    .brand img{height:42px; width:auto; display:block; filter:drop-shadow(0 2px 10px rgba(255,138,0,.2))}
    .brand span{font-size:1.3rem;color:var(--accent);}

    .btn-back {
  padding: 0.9rem 1.6rem;
  border-radius: 999px;
  border: none;
  background: #ff8a00;
  color: #1e1130;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  transition: background 0.3s, transform 0.2s;
}
.btn-back:hover {
  background: darkorange;
  transform: scale(1.05);
}
    main{display:grid;grid-template-columns:1fr 0.8fr;gap:2rem;padding:2rem 0}
    @media(max-width:960px){main{grid-template-columns:1fr}}
    .card{background:linear-gradient(145deg,var(--card),#1a0f2a);border-radius:18px;padding:1.5rem}
    h2{font-size:1.6rem;font-weight:800;margin-bottom:.8rem}
    .controls{display:flex;gap:.6rem;flex-wrap:wrap;margin-bottom:1rem}
    .controls select,.controls button{padding:.6rem .9rem;border-radius:12px;border:1px solid #2a1645;background:#160c23;color:var(--text);cursor:pointer}
    .stats{display:flex;gap:1rem;flex-wrap:wrap;font-size:.9rem;color:var(--muted);margin-top:.6rem}
    #boardWrap{margin-top:1rem;border-radius:14px;padding:12px;background:#170c25;max-width:480px;aspect-ratio:1/1;margin-inline:auto}
    .grid{display:grid;gap:8px;width:100%;height:100%}
    .tile{display:flex;align-items:center;justify-content:center;border-radius:8px;font-weight:800;font-size:clamp(18px,4vw,28px);background:linear-gradient(145deg,var(--primary),#2a1645);color:#fff;cursor:pointer}
    .tile.empty{background:transparent;cursor:default}
    .records{margin-top:1rem;font-size:.9rem;color:var(--accent);font-weight:600}
    /* Modal de Parab√©ns */
    #congratsOverlay{
      position:fixed;top:0;left:0;width:100%;height:100%;
      background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;
      z-index:999;flex-direction:column;display:none;
    }
    #congratsBox{
      background:#1e1130;padding:2rem 3rem;border-radius:16px;text-align:center;
      color:#fff;box-shadow:0 0 30px rgba(0,0,0,0.5);
      animation:pop 0.6s ease;
    }
    #congratsBox h2{color:var(--accent);margin-bottom:.5rem}
    @keyframes pop{0%{transform:scale(0.5);opacity:0}100%{transform:scale(1);opacity:1}}
    canvas#confetti{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1000}
    /* Bot√£o Fechar */
    #closeBtn{
      margin-top:1rem;
      width:40px;height:40px;
      border:none;
      border-radius:50%;
      font-size:1.2rem;
      font-weight:bold;
      cursor:pointer;
      background:var(--accent);
      color:#fff;
      box-shadow:0 0 12px rgba(0,0,0,0.4);
      transition:transform 0.2s, background 0.2s;
    }
    #closeBtn:hover{
      background:var(--success);
      transform:scale(1.1) rotate(90deg);
    }
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <a class="brand">
        <img src="Logo.png" alt="Logo SCALFORCE" style="height:42px">
        <span>ScalForce</span>
      </a>
      <button class="btn-back" onclick="window.location.href='../ScalForce.html'">Voltar</button>
    </div>
  </header>

  <main class="container">
    <section class="card">
      <h2>Quebra-Cabe√ßa de N√∫meros</h2>
      <div class="controls">
        <label for="size">Tamanho</label>
        <select id="size">
          <option value="3">3 x 3</option>
          <option value="4" selected>4 x 4</option>
          <option value="5">5 x 5</option>
        </select>
        <button id="shuffleBtn">Embaralhar</button>
        <button id="solveBtn">Resolver</button>
      </div>

      <div class="stats">
        <div>Movimentos: <span id="moves">0</span></div>
        <div>Tempo: <span id="time">00:00</span></div>
        <div id="status"></div>
      </div>

      <div id="boardWrap"></div>

      <div class="records">
        Recorde <span id="record-size"></span>:  
        ‚è±Ô∏è <span id="best-time">--:--</span> | üéØ <span id="best-moves">--</span>
      </div>
    </section>

    <aside class="card">
      <h3>Como jogar</h3>
      <ol style="color:var(--muted);padding-left:18px;margin:1rem 0">
        <li>Clique em uma pe√ßa adjacente ao espa√ßo vazio para mov√™-la.</li>
        <li>Reorganize os n√∫meros em ordem crescente, da esquerda para a direita, de cima para baixo.</li>
        <li>Use o bot√£o "Embaralhar" para come√ßar uma nova partida.</li>
      </ol>
      <hr style="border:none;border-top:1px solid rgba(255,255,255,.08);margin:1rem 0" />
      
      <h4>Dicas</h4>
      <ul style="color:var(--muted);padding-left:18px;margin:1rem 0;list-style:disc">
        <li>Comece organizando a primeira linha antes das demais.</li>
        <li>Resolva uma linha ou coluna por vez.</li>
        <li>Use o espa√ßo vazio para planejar movimentos estrat√©gicos.</li>
        <li>N√£o se preocupe com a √∫ltima pe√ßa at√© quase o final.</li>
        <li>Visualize onde cada n√∫mero deve estar antes de mover.</li>
        <li>Se ficar preso, embaralhe e tente novamente.</li>
        <li>Pratique para melhorar seu tempo e n√∫mero de movimentos.</li>
        <li>Planeje com anteced√™ncia: antes de mover, pense em como cada movimento vai afetar a posi√ß√£o das outras pe√ßas.</li>
        <li>Mantenha a calma: n√£o tenha pressa, √†s vezes √© melhor dar alguns passos ‚Äúpara tr√°s‚Äù para abrir espa√ßo.</li>
        <li>Priorize os cantos: deixar os cantos certos fixos facilita organizar as linhas seguintes.</li>
        <li>Use padr√µes repetitivos: aprenda sequ√™ncias de movimentos que resolvem situa√ß√µes comuns.</li>
        <li>Treine diferentes tamanhos: alternar entre 3x3, 4x4 e 5x5 melhora sua vis√£o estrat√©gica e rapidez.</li>
      </ul>
    </aside>
  </main>

  <!-- Overlay de Parab√©ns -->
  <div id="congratsOverlay">
    <canvas id="confetti"></canvas>
    <div id="congratsBox">
      <h2>üéâ Novo Recorde! üéâ</h2>
      <p id="congratsText"></p>
      <button id="closeBtn">‚úï</button>
    </div>
  </div>

<script>
(() => {
  const boardWrap=document.getElementById('boardWrap');
  const sizeSelect=document.getElementById('size');
  const shuffleBtn=document.getElementById('shuffleBtn');
  const movesEl=document.getElementById('moves');
  const timeEl=document.getElementById('time');
  const statusEl=document.getElementById('status');
  const solveBtn=document.getElementById('solveBtn');

  const bestTimeEl=document.getElementById('best-time');
  const bestMovesEl=document.getElementById('best-moves');
  const recordSizeEl=document.getElementById('record-size');

  let size=parseInt(sizeSelect.value,10),tiles=[],emptyIndex=null,moves=0,timer=null,seconds=0,started=false;

  function formatTime(s){const mm=String(Math.floor(s/60)).padStart(2,'0');const ss=String(s%60).padStart(2,'0');return mm+':'+ss;}
  function startTimer(){if(timer)return;timer=setInterval(()=>{seconds++;timeEl.textContent=formatTime(seconds)},1000)}
  function stopTimer(){clearInterval(timer);timer=null}
  function resetTimer(){stopTimer();seconds=0;timeEl.textContent='00:00'}
  function buildSolved(n){const arr=[];for(let i=1;i<=n*n-1;i++)arr.push(i);arr.push(0);return arr}

  function render(){
    const grid=document.createElement('div');grid.className='grid';grid.style.gridTemplateColumns=`repeat(${size},1fr)`;grid.style.gridTemplateRows=`repeat(${size},1fr)`;
    boardWrap.innerHTML='';boardWrap.appendChild(grid);
    tiles.forEach((num,idx)=>{
      const el=document.createElement('div');el.className='tile'+(num===0?' empty':'');el.textContent=num===0?'':num;el.dataset.index=idx;el.addEventListener('click',()=>{if(canMove(idx))moveTile(idx)});grid.appendChild(el);
    });
  }

  function canMove(idx){const row=Math.floor(idx/size),col=idx%size;const er=Math.floor(emptyIndex/size),ec=emptyIndex%size;return Math.abs(row-er)+Math.abs(col-ec)===1}
  function moveTile(idx){[tiles[idx],tiles[emptyIndex]]=[tiles[emptyIndex],tiles[idx]];emptyIndex=idx;moves++;movesEl.textContent=moves;if(!started){started=true;startTimer()}render();if(isSolved())onWin()}
  function isSolved(){for(let i=0;i<tiles.length-1;i++){if(tiles[i]!==i+1)return false}return tiles[tiles.length-1]===0}

  function shuffle(times=200){tiles=buildSolved(size);emptyIndex=tiles.indexOf(0);for(let i=0;i<times;i++){const er=Math.floor(emptyIndex/size),ec=emptyIndex%size;const movesList=[];[[er-1,ec],[er+1,ec],[er,ec-1],[er,ec+1]].forEach(([r,c])=>{if(r>=0&&r<size&&c>=0&&c<size)movesList.push(r*size+c)});const choice=movesList[Math.floor(Math.random()*movesList.length)];[tiles[choice],tiles[emptyIndex]]=[tiles[emptyIndex],tiles[choice]];emptyIndex=choice}moves=0;movesEl.textContent=moves;resetTimer();started=false;statusEl.textContent='';render();updateRecordDisplay()}

  function onWin(){
    stopTimer();
    statusEl.textContent='Voc√™ venceu!';
    statusEl.style.color='var(--success)';

    const recordKey=`record-${size}`;
    const current={time:seconds,moves:moves};
    const saved=JSON.parse(localStorage.getItem(recordKey));
    let newRecord=false;

    if(!saved || current.time<saved.time || (current.time===saved.time && current.moves<saved.moves)){
      localStorage.setItem(recordKey,JSON.stringify(current));
      newRecord=true;
    }
    updateRecordDisplay();
    if(newRecord) showCongrats(current);
  }

  function updateRecordDisplay(){
    recordSizeEl.textContent=size+"x"+size;
    const saved=JSON.parse(localStorage.getItem(`record-${size}`));
    if(saved){
      bestTimeEl.textContent=formatTime(saved.time);
      bestMovesEl.textContent=saved.moves;
    }else{
      bestTimeEl.textContent="--:--";
      bestMovesEl.textContent="--";
    }
  }

  // === Tela de Parab√©ns com Confete ===
  function showCongrats(record){
    const overlay=document.getElementById("congratsOverlay");
    const text=document.getElementById("congratsText");
    text.textContent=`Novo recorde no ${size}x${size}! Tempo: ${formatTime(record.time)} | Movimentos: ${record.moves}`;
    overlay.style.display="flex";
    launchConfetti();
  }

  // Confete simples em canvas
  function launchConfetti(){
    const canvas=document.getElementById("confetti");
    const ctx=canvas.getContext("2d");
    canvas.width=window.innerWidth;canvas.height=window.innerHeight;
    let pieces=Array.from({length:150},()=>({
      x:Math.random()*canvas.width,
      y:Math.random()*canvas.height - canvas.height,
      r:5+Math.random()*10,
      d:Math.random()*Math.PI*2,
      color:`hsl(${Math.random()*360},100%,50%)`,
      tilt:Math.random()*10,
      tiltAngle:0
    }));
    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      pieces.forEach(p=>{
        ctx.beginPath();
        ctx.fillStyle=p.color;
        ctx.ellipse(p.x,p.y,p.r,p.r/2,p.tiltAngle,0,2*Math.PI);
        ctx.fill();
      });
      update();
    }
    function update(){
      pieces.forEach(p=>{
        p.y+=2+Math.random()*3;
        p.x+=Math.sin(p.d);
        p.tiltAngle+=0.1;
        if(p.y>canvas.height){p.y=-10;p.x=Math.random()*canvas.width;}
      });
    }
    (function animate(){draw();requestAnimationFrame(animate)})();
    setTimeout(()=>{ctx.clearRect(0,0,canvas.width,canvas.height)},5000);
  }

  // Bot√£o fechar
  document.getElementById("closeBtn").addEventListener("click",()=>{
    document.getElementById("congratsOverlay").style.display="none";
  });

  sizeSelect.addEventListener('change',()=>{size=parseInt(sizeSelect.value,10);shuffle(300)});
  shuffleBtn.addEventListener('click',()=>shuffle(300));
  solveBtn.addEventListener('click',()=>{tiles=buildSolved(size);emptyIndex=tiles.indexOf(0);render();stopTimer();started=false;statusEl.textContent='Resolvido';moves=0;movesEl.textContent=moves});

  tiles=buildSolved(size);emptyIndex=tiles.indexOf(0);shuffle(300);
})();
</script>
</body>
</html>
